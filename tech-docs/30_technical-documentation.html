<!doctype html>
<html lang="de">
<head>
  
  <!-- tech-docs/30_technical-documentation.html -->
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <meta content="jbake" name="generator">
  <meta content="INDEX, FOLLOW" name="ROBOTS">

  <title>Workflow</title>
  <meta content="docToolchain" property="og:title">
  <meta content="build your dev docs the easy way..." property="og:description">
  <meta content="website" property="og:type">
  <meta content="docToolchain" property="og:site_name">
  <meta content="docToolchain" itemprop="name">
  <meta content="build your dev docs the easy way..." itemprop="description">
  <meta content="summary" name="twitter:card">
  <meta content="docToolchain" name="twitter:title">
  <meta content="build your dev docs the easy way..." name="twitter:description">

  <link as="style" href="../css/main.min.881fe5f7b53609f55ebfb496c7097c3b30b2e8ceb20a54bc6a48350ded67224f.css"
        rel="preload">
  <link href="../css/main.min.881fe5f7b53609f55ebfb496c7097c3b30b2e8ceb20a54bc6a48350ded67224f.css" integrity=""
        rel="stylesheet">
  <link href="../css/asciidoctor.css" rel="stylesheet">
  <link href="../css/prettify.css" rel="stylesheet">

    <!-- favicon generated with https://www.favicon-generator.org/ -->
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="apple-touch-icon" sizes="57x57" href="../apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="../apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="../android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
    <link rel="manifest" href="../manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="../ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

  <script src="../js/jquery-3.5.1.min.js"></script>
  <style>
      div.bg-light {
          background-color: rgba(127, 180, 224, 0.3) !important;
      }
      //for blog posts

  span.blogtag {
      border-radius: 10px;
      background-color: #30638E;
      color: white;
      padding: 5px 10px;
  }
  span.blogblogtag a {
      color: white;
      padding: 0
  }
  span.blogtag span {
      margin-left: 10px;
      border-radius: 10px;
      background-color: white;
      color: #30638E;
  }
  div.td-toc {
    height: calc(100vh - 5rem) !important;
  }
  div#toctitle {
    display: none
  }
  #td-section-nav {
    max-height: calc(100vh - 4rem);
    font-size: smaller;
    line-hight: 1.1;
  }
  .td-page-meta {
      font-size: smaller;
      line-hight: 1.1;
  }
  #td-section-nav ul.td-sidebar-nav__section  {
    padding-left:0px;
  }
  .match {
      font-size: smaller;
  }
      .admonitionblock td.icon .fa:before {
          font-size: xxx-large;
      }
  </style>

   <style>
    div.openblock.primary div.content, div.openblock.secondary div.content {
        border: 1px solid #7a2518;
        padding: 5px;
    }
    div.openblock.primary div.content div.content, div.openblock.secondary div.content div.content {
        border: 0px solid #7a2518;
        padding: 0;
    }

    .hidden {
        display: none;
    }

    .switch {
        border-width: 1px 1px 0 1px;
        border-style: solid;
        border-color: #7a2518;
        display: inline-block;
    }

    .switch--item {
        padding: 2px 10px;
        background-color: #ffffff;
        color: #7a2518;
        display: inline-block;
        cursor: pointer;
    }

    .switch--item:not(:first-child) {
        border-width: 0 0 0 1px;
        border-style: solid;
        border-color: #7a2518;
    }

    .switch--item.selected {
        background-color: #7a2519;
        color: #ffffff;
    }
    </style>


</head>

<body onload="prettyPrint()" class="td-section">
<header>
	
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
    <a class="navbar-brand" href="../index.html">
        <span class="navbar-logo"></span><span
            class="font-weight-bold">ucascade</span>
    </a>
    <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
        <ul class="navbar-nav mt-2 mt-lg-0">
    <li class="nav-item mr-4 mb-2 mb-lg-0"><!--img src="../images/status.png" alt="status" width="16" height="16" onerror="this.style.display='none'"--></li>

            <li class="nav-item mr-4 mb-2 mb-lg-0">
                <a class="nav-link active" href="../tech-docs/index.html"><span>Technical docs</span></a>
            </li>

            <li class="nav-item mr-4 mb-2 mb-lg-0">
                <a class="nav-link " href="../user-docs/index.html"><span>User docs</span></a>
            </li>

        </ul>
    </div>
    <div class="navbar-nav d-none d-lg-block" >
        <form action="../search.html">
        <input aria-label="Search this site…" autocomplete="off" class="form-control td-search-input"
               placeholder=" Search this site…" type="search" name="q">
        </form>
    </div>
</nav>

</header>
<div class="container-fluid td-outer">
	<div class="td-main">
		<div class="row flex-xl-nowrap">
			<div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
				<div class="td-sidebar__inner" id="td-sidebar-menu" >
					
        <form class="td-sidebar__search d-flex align-items-center d-lg-none" action="../search.html">

            <input aria-label="Search this site…" name="q" autocomplete="off" class="form-control td-search-input"
                   placeholder=" Search this site…" type="search">


            <button aria-controls="td-docs-nav" aria-expanded="false"
                    aria-label="Toggle section navigation" class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" data-target="#td-section-nav"
                    data-toggle="collapse" type="button">
            </button>
        </form>

        <nav class="collapse td-sidebar-nav" id="td-section-nav" >

            <ul class="td-sidebar-nav__section pr-md-3">
                <li class="td-sidebar-nav__section-title">
                    <span class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Technical docs</span>
                </li>
                <ul>
                    <li class="collapse show" id="docs">
                        
                        <ul class="td-sidebar-nav__section pr-md-3 ul-0">
                            <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child">
                                <a class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section "
                                   href="../tech-docs/index.html">Introduction</a>
                            </li>
                            <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child">
                                <a class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section "
                                   href="../tech-docs/10_setup.html">Setup</a>
                            </li>
                            <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child">
                                <a class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section "
                                   href="../tech-docs/11_ucascade-configuration-file.html">Configuration File</a>
                            </li>
                            <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child">
                                <a class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section "
                                   href="../tech-docs/20_endpoints.html">Endpoints</a>
                            </li>
                            <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child">
                                <a class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section active"
                                   href="../tech-docs/30_technical-documentation.html">Workflow</a>
                            </li>
                            <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child">
                                <a class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section "
                                   href="../tech-docs/40_unit-test-example-files.html">Unit test files</a>
                            </li>
                            <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child">
                                <a class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section "
                                   href="../tech-docs/50_build.html">Build</a>
                            </li>
                        </ul>
                    </li>
                </ul>
        </nav>

				</div>
			</div>
			<div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
				<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
					

        <a href="https://github.com/unblu/ucascade/edit/main/_documentation/src/docs/tech-docs/30_technical-documentation.adoc"
           target="_blank"><i class="fa fa-edit fa-fw"></i> Improve this doc</a>


        <a href="https://github.com/unblu/ucascade/issues?title=Docs%3A+Feedback+for+%27Workflow%27&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23page:%20https://github.com/unblu/ucascade/edit/main/_documentation/src/docs/tech-docs/30_technical-documentation.adoc%0A%23branch:%20null" target="_blank"><i
                class="fab fa-github fa-fw"></i> Create an issue</a>

        
        <hr />

        <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_high_level_workflow">High-level Workflow</a></li>
<li><a href="#_technical_workflow_ucascade">Technical Workflow - ucascade</a>
<ul class="sectlevel2">
<li><a href="#_merge_request_events">Merge Request events</a></li>
<li><a href="#_actions">Actions</a></li>
</ul>
</li>
</ul>
</div>



				</div>
			</div>
			<main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
				    <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
        <ol class="breadcrumb spb-1">
            <!--li aria-current="page" class="breadcrumb-item active">
                <a href="https://example.docsy.dev/docs/">Documentation</a>
            </li-->

        </ol>
    </nav>


    <div class="td-content">
        <p>
            
<div class="imageblock">
<div class="content">
<img src="../images/Unblu-logo.png" alt="Unblu logo">
</div>
</div>
<div class="sect1">
<h2 id="_high_level_workflow">High-level Workflow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this example, one automatic cascade merge is to be performed. E.g., User is merging <code>feature/1.3.x/my_feature</code> into <code>main/1.3.x</code>, which has as target the "final" branch <code>develop</code>.</p>
</div>
<div class="paragraph">
<p>When the merge event targets a "final" branch, <code>ucascade</code> ignores it. Similarly, when a merge request created automatically by <code>ucascade</code> cannot be merged due to conflicts between the source and target branches, <code>ucascade</code> cannot continue and the execution is aborted. If properly configured, Gitlab notifies the users about the conflicting MR.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/diag-9e2877bb1bf4ca959010557ba9c69605.svg" alt="diag 9e2877bb1bf4ca959010557ba9c69605" width="1258" height="1012">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_technical_workflow_ucascade">Technical Workflow - ucascade</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using the "blocking" or "replay" <a href="20_endpoints.html">endpoints</a>, the returned object contains some indications about the items created by the different actions.
If one of those actions is failing, the error message will be displayed in the returned object with the <code>_error</code> suffix.</p>
</div>
<div class="sect2">
<h3 id="_merge_request_events">Merge Request events</h3>
<div class="sect3">
<h4 id="_merge_event">Merge event</h4>
<div class="paragraph">
<p>For a given merge request <code>merge</code> event, 3 different independent actions can be made:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>previous_auto_mr_merged</code>: if the merged-request event corresponds to the merge of an auto merge-request, and some other auto-merge requests are open between the same two branches, then the oldest auto merge request is merged.</p>
</li>
<li>
<p><code>created_auto_mr</code>: if the merged-request event corresponds to the merge of any merge request that requires an auto merge-request to be created (to cascade the change to the next branch), it is created and potentially directly merged. With the "blocking" and "replay" endpoints, the returned object contains a <code>created_auto_mr.ucascade_state</code> field indicating if the action was successful or why it was not. It can take the values of:</p>
<div class="ulist">
<ul>
<li>
<p>MERGED: MR was created and merged succesfully</p>
</li>
<li>
<p>NOT_MERGED_CONFLICTS: MR was created but not merged due to existing conflicts between source and target branches that must be manually resolved</p>
</li>
<li>
<p>NOT_MERGED_CONCURRENT_MRS: MR was created but not merged due to another existing open merge request between the same source and target branches</p>
</li>
<li>
<p>NOT_MERGED_UNKNOWN_REASON: MR was created but not merged due to an unknown/unexpected reason</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>existing_branch_deleted</code>: if the merged-request event corresponds to the <strong>merge</strong> of an auto merge-request and the source branch is still present, it gets deleted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The failure of one of those action will not prevent the next to be executed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_close_event">Close event</h4>
<div class="paragraph">
<p>For a given merge request <code>close</code> event, 2 different independent actions can be made:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>existing_branch_deleted</code>: if the merge-request event corresponds to the <strong>close</strong> of an auto merge-request, the source branch gets deleted</p>
</li>
<li>
<p><code>previous_auto_mr_merged</code>: if some other auto-merge requests are open between the same two branches, then the oldest auto merge request is merged.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_actions">Actions</h3>
<div class="sect3">
<h4 id="_previous_auto_mr_merged">previous_auto_mr_merged</h4>
<div class="paragraph">
<p>When a lot of changes are made concurrently, it can be that multiple auto-merge requests are created between the same main branches (<code>main/1.2.x</code> and <code>main/1.3.x</code>).
In such cases, only the first one is set up to be merged directly.
This means that when the auto-merge request finally gets merged or closed, any other pending auto-merge requests between the same branches must still be merged.
ucascade starts with the oldest one.</p>
</div>
</div>
<div class="sect3">
<h4 id="_created_auto_mr">created_auto_mr</h4>
<div class="paragraph">
<p>This explains how ucascade determines if a new auto-merge request is created or not:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/diag-75e6c5bc8efde317863b9cd9f8bb7158.svg" alt="diag 75e6c5bc8efde317863b9cd9f8bb7158" width="1475" height="1529">
</div>
</div>
<div class="paragraph">
<p>During the final stage of the success case&#8201;&#8212;&#8201;merging the MR&#8201;&#8212;&#8201;<code>ucascade</code> verifies if that MR has any pipeline configured. If it has, the flag <code>merge_when_pipeline_succeeds</code> is set to <code>true</code>, meaning that the merge is only to happen after all its pipelines have finished successfully. Otherwise, if it doesn&#8217;t have any pipeline, this flag is set to <code>false</code>, preventing GitLab to return a 405 error (see <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/355455">issue #355455</a> for more details).</p>
</div>
</div>
<div class="sect3">
<h4 id="_existing_branch_deleted">existing_branch_deleted</h4>
<div class="paragraph">
<p>Whenever a user closes an auto merge-request, the source branch is not deleted automatically. Additionally, sometimes when a merge-request is merged, its source branch is not deleted by gitlab. Ucascade makes sure that in both of these situations, the source branch gets deleted.</p>
</div>
</div>
</div>
</div>
</div>
        </p>

        <style>
.feedback--answer {
    display: inline-block;
}

.feedback--answer-no {
    margin-left: 1em;
}

.feedback--response {
    display: none;
    margin-top: 1em;
}

.feedback--response__visible {
    display: block;
}
</style>

<div class="d-print-none">
    <h2 class="feedback--title">Feedback</h2>
    <p class="feedback--question">Was this page helpful?</p>
    <button class="feedback--answer feedback--answer-yes">Yes</button>
    <button class="feedback--answer feedback--answer-no">No</button>
    <p class="feedback--response feedback--response-yes">
        Glad to hear it! Please <a href="https://github.com/unblu/ucascade/issues?title=Docs%3A+Feedback+for+%27Workflow%27%20%F0%9F%91%8D&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23page:tech-docs/30_technical-documentation.adoc">tell us
    how we can improve</a>.
    </p>
    <p class="feedback--response feedback--response-no">
        Sorry to hear that. Please <a href="https://github.com/unblu/ucascade/issues?title=Docs%3A+Feedback+for+%27Workflow%27%20%F0%9F%91%8E&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23page:tech-docs/30_technical-documentation.adoc">tell
    us how we can improve</a>.
    </p>
</div>
<script>
    const yesButton = document.querySelector('.feedback--answer-yes');
    const noButton = document.querySelector('.feedback--answer-no');
    const yesResponse = document.querySelector('.feedback--response-yes');
    const noResponse = document.querySelector('.feedback--response-no');
    const disableButtons = () => {
        yesButton.disabled = true;
        noButton.disabled = true;
    };
    const sendFeedback = (value) => {
        if (typeof ga !== 'function') return;
        const args = {
            command: 'send',
            hitType: 'event',
            category: 'Helpful',
            action: 'click',
            label: window.location.pathname,
            value: value
        };
        ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
    };
    yesButton.addEventListener('click', () => {
        yesResponse.classList.add('feedback--response__visible');
        disableButtons();
        sendFeedback(1);
    });
    noButton.addEventListener('click', () => {
        noResponse.classList.add('feedback--response__visible');
        disableButtons();
        sendFeedback(0);
    });
</script>


        <br>

        <!--div class="text-muted mt-5 pt-3 border-top">Last modified July 3, 2019: <a
                href="https://github.com/google/docsy-example/commit/d6aa89c8b24089d7e6741030864eff209465e896">Added
            links to user guide repo (d6aa89c)</a>
        </div-->
    </div>


			</main>

		</div>
	</div>


	
    <!--footer class="footer mt-auto py-3 bg-light">
        <div class="container">
            <span class="text-muted">&copy; 2020 | based on <a href="https://arc42.org">arc42 7.0</a> | mixed with <a href="http://getbootstrap.com/">Bootstrap v5.0.0-beta</a> | Baked with <a href="http://jbake.org">JBake v2.6.7</a></span>
        </div>
    </footer-->

    <footer class="bg-dark py-5 row d-print-none">
        <div class="container-fluid mx-sm-5">
            <div class="row">
                <div class="col-6 col-sm-4 text-xs-center order-sm-2">


                    <ul class="list-inline mb-0">
                        
                        <li aria-label="User mailing list" class="list-inline-item mx-2 h3" data-original-title="User mailing list" data-placement="top"
                            data-toggle="tooltip" title="">
                            <a class="text-white" href="mailto:mailto:dev@unblu.com" rel="noopener noreferrer"
                               target="_blank">
                                <i class="fa fa-envelope"></i>
                            </a>
                        </li>
                        
                        
                        <li aria-label="Twitter" class="list-inline-item mx-2 h3" data-original-title="Twitter" data-placement="top"
                            data-toggle="tooltip" title="">
                            <a class="text-white" href="https://twitter.com/Unblu" rel="noopener noreferrer"
                               target="_blank">
                                <i class="fab fa-twitter"></i>
                            </a>
                        </li>
                        
                        
                    </ul>


                </div>
                <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">


                    <ul class="list-inline mb-0">

                        
                        <li aria-label="GitHub" class="list-inline-item mx-2 h3" data-original-title="GitHub" data-placement="top"
                            data-toggle="tooltip" title="">
                            <a class="text-white" href="https://github.com/unblu/ucascade" rel="noopener noreferrer"
                               target="_blank">
                                <i class="fab fa-github"></i>
                            </a>
                        </li>
                        

                        


                    </ul>


                </div>
                <div class="col-12 col-sm-4 text-center py-2 order-sm-2">

                        

                </div>
            </div>
        </div>
    </footer>

    <script src="../js/popper.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>


    <script src="../js/main.min.b5fc1b29d2465835844254bd4d804738eaf24c0cec53009b4c6899989be55a47.js"></script>
    <script src="../js/blocks.js" ></script>
    <script src="../js/prettify.js"></script>


</body>
</html>
